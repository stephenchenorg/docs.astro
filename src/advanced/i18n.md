# 多語系

*TODO*

## 安裝套件

安裝 [@astrolicious/i18n](https://astro-i18n.netlify.app/) 套件：

```bash
yarn add @astrolicious/i18n
```

`astro.config.ts`：

```ts
import { defineConfig } from 'astro/config'
import i18n from '@astrolicious/i18n'

export default defineConfig({
  integrations: [
    i18n({
      defaultLocale: 'zh-TW',
      locales: ['zh-TW', 'en'],
    }),
  ],
})

```

## Layout 語系設定

*TODO*

```astro
---
import I18nHead from '@astrolicious/i18n/components/I18nHead.astro'
import { getHtmlAttrs, getLocale } from 'i18n:astro'
import type { PageMeta } from '@stephenchenorg/astro/page'
import type { CompanySetting } from '@stephenchenorg/astro/company-setting'

// ...

const locale = getLocale()

const htmlLangMap: Record<string, string> = {
  'zh-TW': 'zh-Hant-TW',
}

const htmlAttrs = getHtmlAttrs()
htmlAttrs.lang = htmlLangMap[locale] || locale
---

<!doctype html>
<html {...htmlAttrs}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />

    <I18nHead />
  </head>
  <body>
  </body>
</html>
```

## 設定多語系路由

*TODO*

`routes`：

```
src/
  └── routes/
      ├── about.astro
      ├── index.astro
      └── posts/
          ├── [id].astro
          └── index.astro
```

*TODO*

```
zh-TW:
/
/posts/
/posts/1/
/about/

en:
/en/
/en/posts/
/en/posts/1/
/en/about/
```

*TODO*

## 設定翻譯檔

*TODO*

`src/locales/en/common.json`：

```json
{
  "hello": "Hello",
  "world": "World",
  "nav_about": "About",
  "nav_home": "Home",
  "nav_posts": "Posts"
}
```

*TODO*

`src/locales/zh-TW/common.json`：

```json
{
  "hello": "你好",
  "world": "世界",
  "nav_about": "關於",
  "nav_home": "首頁",
  "nav_posts": "文章"
}
```

*TODO*

## 翻譯文字

*TODO*

```astro
---
import { t, getLocalePath } from 'i18n:astro'
---

<div>
  <h1>{t('hello')}</h1>
  <p>{t('world')}</p>
</div>
```

## 語系連結

*TODO*

```astro
---
import { t, getLocalePath } from 'i18n:astro'
---

<a href={getLocalePath('/')}>{t('nav_home')}</a>
```

## Layout 增加語系切換選項

*TODO*

```astro
---
import I18nHead from '@astrolicious/i18n/components/I18nHead.astro'
import { t, getHtmlAttrs, getLocale, getLocalePath, getSwitcherData } from 'i18n:astro'
import type { PageMeta } from '@stephenchenorg/astro/page'
import type { CompanySetting } from '@stephenchenorg/astro/company-setting'

// ...

const pathname = Astro.url.pathname
const switcherData = getSwitcherData()

const switcherLabels: Record<string, string> = {
  en: 'English',
  'zh-TW': '繁體中文',
}
---

<!doctype html>
<html {...htmlAttrs}>
  <body>

    <nav>
      <ul>
        <li class:list={[pathname === getLocalePath('/') && 'active']}>
          <a href={getLocalePath('/')}>{t('nav_home')}</a>
        </li>
        <li class:list={[pathname.startsWith(getLocalePath('/posts')) && 'active']}>
          <a href={getLocalePath('/posts/')}>{t('nav_posts')}</a>
        </li>
        <li class:list={[pathname === getLocalePath('/about/') && 'active']}>
          <a href={getLocalePath('/about/')}>{t('nav_about')}</a>
        </li>
        <li>
          <a href="#">{switcherLabels[locale]}</a>
          <ul>
            {switcherData.map(item => (
              <li>
                <a href={`${item.href.replace(/\/$/, '')}/`}>{switcherLabels[item.locale]}</a>
              </li>
            ))}
          </ul>
        </li>
      </ul>
    </nav>

  </body>
</html>
```
